<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV è³‡æ–™åœ–è¡¨é¡¯ç¤º</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 0;
        }

        .help-button {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .help-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) scale(1.1);
        }
        
        .controls {
            padding: 20px 30px;
            text-align: center;
            background: #f8f9fa;
        }
        
        .file-input-wrapper {
            display: inline-block;
            position: relative;
            overflow: hidden;
        }
        
        .btn {
            display: inline-block;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-info {
            margin-top: 15px;
            font-size: 1em;
            color: #666;
        }
        
        .file-info.active {
            color: #667eea;
            font-weight: bold;
        }

        .title-container {
            padding: 15px 30px 0 30px;
            text-align: center;
        }

        #chartTitle {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            padding: 10px;
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
            min-width: 200px;
        }

        #chartTitle:hover {
            background: #f0f0f0;
            border-color: #667eea;
        }

        #titleInput {
            display: none;
            font-size: 1.5em;
            font-weight: bold;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 5px;
            text-align: center;
            outline: none;
            min-width: 300px;
        }

        #titleInput.active {
            display: inline-block;
        }

        .main-content {
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #dee2e6;
            display: none;
        }

        .sidebar.active {
            display: block;
        }

        .sidebar-section {
            margin-bottom: 25px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .sidebar-section h3 {
            font-size: 1em;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #667eea;
        }

        .hover-control {
            margin-bottom: 15px;
        }

        .hover-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .hover-button {
            padding: 8px 12px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .hover-button:hover {
            background: #f0f0ff;
        }

        .hover-button.active {
            background: #667eea;
            color: white;
        }

        .axis-control {
            margin-bottom: 15px;
        }

        .axis-control label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
            font-size: 0.95em;
        }

        .range-inputs {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .range-inputs input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .range-inputs input::placeholder {
            color: #999;
            font-size: 0.85em;
        }

        .apply-btn {
            width: 100%;
            padding: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .apply-btn:hover {
            background: #5568d3;
        }

        .chart-container {
            flex: 1;
            min-width: 0;
            max-width: calc(100% - 300px);
        }
        
        #plotDiv {
            width: calc(100% - 20px);
            max-width: 100%;
            height: 700px;
            padding: 20px 10px 20px 20px;
        }
        
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 700px;
            color: #999;
        }
        
        .empty-state svg {
            width: 150px;
            height: 150px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .empty-state p {
            font-size: 1.3em;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 1.2em;
        }
        
        .loading.active {
            display: block;
        }
        
        .error {
            display: none;
            background: #fee;
            color: #c33;
            padding: 15px;
            margin: 20px;
            border-radius: 8px;
            border-left: 4px solid #c33;
        }
        
        .error.active {
            display: block;
        }

        /* Modal æ¨£å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 700px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5em;
        }

        .close-button {
            background: none;
            border: none;
            color: white;
            font-size: 2em;
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }

        .close-button:hover {
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
            color: #333;
            line-height: 1.8;
        }

        .help-section {
            margin-bottom: 25px;
        }

        .help-section h3 {
            color: #667eea;
            font-size: 1.2em;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .help-section p {
            margin-bottom: 10px;
            color: #555;
        }

        .help-section ul {
            margin-left: 20px;
            color: #555;
        }

        .help-section li {
            margin-bottom: 8px;
        }

        .help-section code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #667eea;
            font-size: 0.9em;
        }

        .highlight-box {
            background: #f0f5ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .highlight-box strong {
            color: #667eea;
        }

        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                max-width: 100%;
            }
            .chart-container {
                max-width: 100%;
            }
            .modal-content {
                width: 95%;
                max-height: 90vh;
            }
            .help-button {
                right: 15px;
                width: 35px;
                height: 35px;
                font-size: 1.3em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š CSV è³‡æ–™åœ–è¡¨é¡¯ç¤ºå™¨</h1>
            <button class="help-button" onclick="openHelpModal()" title="ä½¿ç”¨èªªæ˜">â“</button>
        </div>
        
        <div class="controls">
            <div class="file-input-wrapper">
                <button class="btn">ğŸ“ é¸æ“‡ CSV æª”æ¡ˆ</button>
                <input type="file" id="fileInput" accept=".csv">
            </div>
            <div class="file-info" id="fileInfo">å°šæœªé¸æ“‡æª”æ¡ˆ</div>
        </div>
        
        <div class="loading" id="loading">â³ æ­£åœ¨è¼‰å…¥è³‡æ–™...</div>
        <div class="error" id="error"></div>

        <div class="title-container">
            <div id="chartTitle" style="display: none;">åœ–è¡¨æ¨™é¡Œ (é›™æ“Šç·¨è¼¯)</div>
            <input type="text" id="titleInput" value="åœ–è¡¨æ¨™é¡Œ">
        </div>
        
        <div class="main-content">
            <div class="sidebar" id="sidebar">
                <!-- Hover æ¨¡å¼æ§åˆ¶ -->
                <div class="sidebar-section">
                    <h3>ğŸ¯ æ»‘é¼ æ‡¸åœæ¨¡å¼</h3>
                    <div class="hover-control">
                        <div class="hover-buttons">
                            <button id="hoverClosest" class="hover-button active" onclick="setHoverMode('closest')">æœ€è¿‘æ•¸æ“š</button>
                            <button id="hoverX" class="hover-button" onclick="setHoverMode('x')">X Marker</button>
                            <button id="hoverY" class="hover-button" onclick="setHoverMode('y')">Y Marker</button>
                            <button id="hoverFalse" class="hover-button" onclick="setHoverMode(false)">é—œé–‰æ‡¸åœ</button>
                        </div>
                    </div>
                </div>

                <!-- è»¸ç¯„åœè¨­å®š -->
                <div class="sidebar-section">
                    <h3>ğŸ“ è»¸ç¯„åœè¨­å®š</h3>
                    <div class="axis-control">
                        <label>X è»¸ç¯„åœ</label>
                        <div class="range-inputs">
                            <input type="text" id="xMin" placeholder="æœ€å°å€¼ (ä¾‹: 1m, 500u, 1.5n)" step="any">
                            <input type="text" id="xMax" placeholder="æœ€å¤§å€¼ (ä¾‹: 10m, 2u, 5n)" step="any">
                        </div>
                    </div>
                    <div class="axis-control">
                        <label>Y è»¸ç¯„åœ</label>
                        <div class="range-inputs">
                            <input type="number" id="yMin" placeholder="æœ€å°å€¼" step="any">
                            <input type="number" id="yMax" placeholder="æœ€å¤§å€¼" step="any">
                        </div>
                    </div>
                    <button class="apply-btn" id="applyRange">å¥—ç”¨ç¯„åœ</button>
                    <button class="apply-btn" id="resetRange" style="background: #6c757d; margin-top: 5px;">é‡è¨­ç¯„åœ</button>
                </div>

                <!-- å¦å­˜æª”æ¡ˆ -->
                <div class="sidebar-section">
                    <h3>ğŸ’¾ å¦å­˜æª”æ¡ˆ</h3>
                    <button class="apply-btn" id="saveHTML" style="background: #28a745;">å¦å­˜ç‚º HTML</button>
                    <button class="apply-btn" id="saveJPG" style="background: #17a2b8; margin-top: 5px;">å¦å­˜ç‚º JPG</button>
                    <div id="saveStatus" style="font-size: 0.85em; color: #666; margin-top: 10px; min-height: 20px;"></div>
                </div>
            </div>

            <div class="chart-container">
                <div id="plotContainer">
                    <div class="empty-state" id="emptyState">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            <path d="M3 10h18M3 14h18"/>
                        </svg>
                        <p>è«‹é¸æ“‡ CSV æª”æ¡ˆé–‹å§‹</p>
                    </div>
                    <div id="plotDiv"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨èªªæ˜ Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“š ä½¿ç”¨èªªæ˜</h2>
                <button class="close-button" onclick="closeHelpModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h3>ğŸ“ CSV æª”æ¡ˆæ ¼å¼è¦æ±‚</h3>
                    <p>CSV æª”æ¡ˆæ‡‰åŒ…å«ï¼š</p>
                    <ul>
                        <li>ç¬¬ä¸€åˆ—ç‚ºæ¨™é¡Œåˆ—ï¼ˆè¡¨é ­ï¼‰</li>
                        <li>ç¬¬ä¸€æ¬„ç‚º X è»¸æ•¸æ“š</li>
                        <li>ä¸­é–“æ¬„ä½ç‚ºå„æ¢æ›²ç·šçš„ Y è»¸æ•¸æ“š</li>
                        <li>æœ€å¾Œä¸€æ¬„ç‚º Y è»¸çš„å–®ä½æ¨™ç±¤</li>
                    </ul>
                    <div class="highlight-box">
                        <strong>ç‰¹æ®ŠåŠŸèƒ½ï¼š</strong>å¦‚æœæ¬„ä½åç¨±åŒ…å« "spec"ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰ï¼Œè©²æ›²ç·šå°‡é¡¯ç¤ºç‚º<strong>æ·±ç²‰ç´…è‰²è™›ç·š</strong>
                    </div>
                </div>

                <div class="help-section">
                    <h3>ğŸ“¤ å¦‚ä½•ä¸Šå‚³æª”æ¡ˆ</h3>
                    <p>é»æ“Šã€ŒğŸ“ é¸æ“‡ CSV æª”æ¡ˆã€æŒ‰éˆ•ï¼Œé¸æ“‡æ‚¨çš„ CSV æª”æ¡ˆå³å¯è‡ªå‹•è¼‰å…¥ä¸¦ç¹ªè£½åœ–è¡¨ã€‚</p>
                </div>

                <div class="help-section">
                    <h3>âœï¸ ç·¨è¼¯åœ–è¡¨æ¨™é¡Œ</h3>
                    <p><strong>é›™æ“Š</strong>åœ–è¡¨ä¸Šæ–¹çš„æ¨™é¡Œå³å¯é€²è¡Œç·¨è¼¯ï¼ŒæŒ‰ Enter æˆ–é»æ“Šå…¶ä»–åœ°æ–¹å®Œæˆç·¨è¼¯ã€‚</p>
                </div>

                <div class="help-section">
                    <h3>ğŸ¯ æ»‘é¼ æ‡¸åœæ¨¡å¼</h3>
                    <ul>
                        <li><strong>æœ€è¿‘æ•¸æ“šï¼š</strong>é¡¯ç¤ºæ¸¸æ¨™æœ€è¿‘çš„æ•¸æ“šé»è³‡è¨Š</li>
                        <li><strong>X Markerï¼š</strong>é¡¯ç¤ºå‚ç›´åƒè€ƒç·šå’Œ Y å€¼</li>
                        <li><strong>Y Markerï¼š</strong>é¡¯ç¤ºæ°´å¹³åƒè€ƒç·šå’Œ X å€¼</li>
                        <li><strong>é—œé–‰æ‡¸åœï¼š</strong>ä¸é¡¯ç¤ºæ‡¸åœè³‡è¨Š</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ“ èª¿æ•´åº§æ¨™è»¸ç¯„åœ</h3>
                    <p><strong>X è»¸</strong>æ”¯æ´ SI å–®ä½å‰ç¶´è¼¸å…¥ï¼š</p>
                    <ul>
                        <li><code>G</code> = 10â¹ (Giga)</li>
                        <li><code>M</code> = 10â¶ (Mega)</li>
                        <li><code>k</code> = 10Â³ (kilo)</li>
                        <li><code>m</code> = 10â»Â³ (milli)</li>
                        <li><code>u</code> = 10â»â¶ (micro)</li>
                        <li><code>n</code> = 10â»â¹ (nano)</li>
                        <li><code>p</code> = 10â»Â¹Â² (pico)</li>
                    </ul>
                    <div class="highlight-box">
                        <strong>ç¯„ä¾‹ï¼š</strong>è¼¸å…¥ <code>1m</code> è¡¨ç¤º 0.001ï¼Œè¼¸å…¥ <code>500u</code> è¡¨ç¤º 0.0005
                    </div>
                    <p>è¼¸å…¥æ•¸å€¼å¾Œé»æ“Šã€Œå¥—ç”¨ç¯„åœã€æŒ‰éˆ•ï¼Œæˆ–é»æ“Šã€Œé‡è¨­ç¯„åœã€æ¢å¾©è‡ªå‹•èª¿æ•´ã€‚</p>
                </div>

                <div class="help-section">
                    <h3>ğŸ’¾ å„²å­˜åœ–è¡¨</h3>
                    <ul>
                        <li><strong>å¦å­˜ç‚º HTMLï¼š</strong>å°‡åœ–è¡¨å’Œç•¶å‰è¨­å®šå„²å­˜ç‚ºç¨ç«‹çš„ HTML æª”æ¡ˆï¼Œå¯ä»¥ç›´æ¥ç”¨ç€è¦½å™¨é–‹å•Ÿä¸¦ä¿ç•™äº’å‹•åŠŸèƒ½</li>
                        <li><strong>å¦å­˜ç‚º JPGï¼š</strong>å°‡åœ–è¡¨åŒ¯å‡ºç‚ºéœæ…‹åœ–ç‰‡ï¼ˆ1280x720 è§£æåº¦ï¼‰ï¼Œé©åˆå ±å‘Šæˆ–æ–‡ä»¶ä½¿ç”¨</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ–±ï¸ åœ–è¡¨äº’å‹•åŠŸèƒ½</h3>
                    <p>Plotly æä¾›äº†è±å¯Œçš„äº’å‹•åŠŸèƒ½ï¼š</p>
                    <ul>
                        <li><strong>ç¸®æ”¾ï¼š</strong>ç”¨æ»‘é¼ æ‹–æ›³é¸å–å€åŸŸé€²è¡Œç¸®æ”¾</li>
                        <li><strong>å¹³ç§»ï¼š</strong>æŒ‰ä½ä¸¦æ‹–æ›³åœ–è¡¨é€²è¡Œå¹³ç§»</li>
                        <li><strong>é‡è¨­è¦–åœ–ï¼š</strong>é›™æ“Šåœ–è¡¨æ¢å¾©åˆå§‹è¦–åœ–</li>
                        <li><strong>é¡¯ç¤º/éš±è—æ›²ç·šï¼š</strong>é»æ“Šå³å´åœ–ä¾‹ä¸­çš„é …ç›®</li>
                        <li><strong>å·¥å…·åˆ—ï¼š</strong>æ»‘é¼ ç§»åˆ°åœ–è¡¨ä¸Šæ–¹æœƒé¡¯ç¤ºç¸®æ”¾ã€å¹³ç§»ã€å„²å­˜ç­‰å·¥å…·</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ’¡ å°æç¤º</h3>
                    <ul>
                        <li>å„²å­˜çš„ HTML æª”æ¡ˆæœƒåµŒå…¥æ‰€æœ‰æ•¸æ“šå’Œè¨­å®šï¼Œå¯é›¢ç·šä½¿ç”¨</li>
                        <li>JPG åŒ¯å‡ºæœƒè‡ªå‹•åŠ ä¸Šæ‚¨è¨­å®šçš„åœ–è¡¨æ¨™é¡Œ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const plotDiv = document.getElementById('plotDiv');
        const emptyState = document.getElementById('emptyState');
        const loading = document.getElementById('loading');
        const errorDiv = document.getElementById('error');
        const chartTitle = document.getElementById('chartTitle');
        const titleInput = document.getElementById('titleInput');
        const sidebar = document.getElementById('sidebar');

        // è»¸ç¯„åœè¼¸å…¥
        const xMin = document.getElementById('xMin');
        const xMax = document.getElementById('xMax');
        const yMin = document.getElementById('yMin');
        const yMax = document.getElementById('yMax');
        const applyRange = document.getElementById('applyRange');
        const resetRange = document.getElementById('resetRange');

        let currentLayout = null;
        let currentTraces = null;
        let currentConfig = null;
        let dataLoaded = false;
        let originalFileName = '';
        // isEmbeddedVersion æœƒåœ¨åµŒå…¥æ•¸æ“šæ™‚è¨­å®š

        // Modal æ§åˆ¶å‡½æ•¸
        function openHelpModal() {
            document.getElementById('helpModal').classList.add('active');
        }

        function closeHelpModal() {
            document.getElementById('helpModal').classList.remove('active');
        }

        // é»æ“Š Modal èƒŒæ™¯é—œé–‰
        document.getElementById('helpModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeHelpModal();
            }
        });

        // ESC éµé—œé–‰ Modal
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeHelpModal();
            }
        });

        // æ¨™é¡Œç·¨è¼¯åŠŸèƒ½
        chartTitle.addEventListener('dblclick', function() {
            chartTitle.style.display = 'none';
            titleInput.classList.add('active');
            titleInput.value = chartTitle.textContent;
            titleInput.focus();
            titleInput.select();
        });

        titleInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                finishEditingTitle();
            }
        });

        titleInput.addEventListener('blur', function() {
            finishEditingTitle();
        });

        function finishEditingTitle() {
            chartTitle.textContent = titleInput.value || 'åœ–è¡¨æ¨™é¡Œ';
            chartTitle.style.display = 'inline-block';
            titleInput.classList.remove('active');
        }

        // Hover æ¨¡å¼åŠŸèƒ½
        function setHoverMode(mode) {
            // æ¸…é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active ç‹€æ…‹
            document.getElementById('hoverClosest').classList.remove('active');
            document.getElementById('hoverX').classList.remove('active');
            document.getElementById('hoverY').classList.remove('active');
            document.getElementById('hoverFalse').classList.remove('active');
            
            // è¨­ç½®å°æ‡‰æŒ‰éˆ•ç‚º active ç‹€æ…‹
            if (mode === 'closest') {
                document.getElementById('hoverClosest').classList.add('active');
            } else if (mode === 'x') {
                document.getElementById('hoverX').classList.add('active');
            } else if (mode === 'y') {
                document.getElementById('hoverY').classList.add('active');
            } else {
                document.getElementById('hoverFalse').classList.add('active');
            }
            
            if (!dataLoaded || !plotDiv || !window.Plotly) return;
            
            // æ ¹æ“šæ¨¡å¼æ›´æ–° hovertemplate
            var newHoverTemplate;
            if (mode === 'x') {
                // X Marker æ¨¡å¼ï¼šæ¡†å…§é¡¯ç¤º Yæ•¸å€¼,æ¡†å¤–é¡¯ç¤ºåœ–ä¾‹å
                newHoverTemplate = '%{y:.6f}<extra>%{fullData.name}</extra>';
            } else if (mode === 'y') {
                // Y Marker æ¨¡å¼ï¼šæ¡†å…§é¡¯ç¤º Xæ•¸å€¼,æ¡†å¤–é¡¯ç¤ºåœ–ä¾‹å
                newHoverTemplate = '%{x:.6f}<extra>%{fullData.name}</extra>';
            } else {
                // å…¶ä»–æ¨¡å¼ï¼šé¡¯ç¤ºå®Œæ•´è³‡è¨Š
                newHoverTemplate = '<b>%{fullData.name}</b><br>X: %{x:.4f}<br>Y: %{y:.4f}<extra></extra>';
            }
            
            // æ›´æ–°æ‰€æœ‰ traces çš„ hovertemplate
            if (currentTraces && currentTraces.length > 0) {
                var traceUpdate = { hovertemplate: [] };
                for (var i = 0; i < currentTraces.length; i++) {
                    traceUpdate.hovertemplate.push(newHoverTemplate);
                }
                Plotly.restyle(plotDiv, traceUpdate);
            }
            
            // å¥—ç”¨åˆ°åœ–è¡¨
            var update = { hovermode: mode };
            
            // æ ¹æ“šæ¨¡å¼è¨­ç½® spike ç·šæ¢
            if (mode === 'x') {
                // X Marker æ¨¡å¼ï¼šé¡¯ç¤ºå‚ç›´ç·š
                update['xaxis.showspikes'] = true;
                update['xaxis.spikemode'] = 'across';
                update['xaxis.spikesnap'] = 'cursor';
                update['xaxis.spikecolor'] = '#4ecdc4';
                update['xaxis.spikethickness'] = 2;
                update['xaxis.spikedash'] = 'solid';
                update['yaxis.showspikes'] = false;
            } else if (mode === 'y') {
                // Y Marker æ¨¡å¼ï¼šé¡¯ç¤ºæ°´å¹³ç·š
                update['yaxis.showspikes'] = true;
                update['yaxis.spikemode'] = 'across';
                update['yaxis.spikesnap'] = 'cursor';
                update['yaxis.spikecolor'] = '#4ecdc4';
                update['yaxis.spikethickness'] = 2;
                update['yaxis.spikedash'] = 'solid';
                update['xaxis.showspikes'] = false;
            } else {
                // å…¶ä»–æ¨¡å¼ï¼šé—œé–‰ spike ç·šæ¢
                update['xaxis.showspikes'] = false;
                update['yaxis.showspikes'] = false;
            }
            
            Plotly.relayout(plotDiv, update);
        }

        // å¥—ç”¨è»¸ç¯„åœ
        applyRange.addEventListener('click', () => {
            if (dataLoaded) {
                updatePlot();
            }
        });

        // é‡è¨­è»¸ç¯„åœ
        resetRange.addEventListener('click', () => {
            xMin.value = '';
            xMax.value = '';
            yMin.value = '';
            yMax.value = '';
            if (dataLoaded) {
                updatePlot();
            }
        });

        // å¦å­˜ç‚º HTML å’Œ JPG
        const saveHTMLBtn = document.getElementById('saveHTML');
        const saveJPGBtn = document.getElementById('saveJPG');
        const saveStatus = document.getElementById('saveStatus');
        
        saveHTMLBtn.addEventListener('click', () => {
            if (!dataLoaded) {
                updateSaveStatus('è«‹å…ˆè¼‰å…¥ CSV æª”æ¡ˆ');
                return;
            }
            saveAsNewHTML();
        });

        // å¦å­˜ç‚º JPG
        saveJPGBtn.addEventListener('click', () => {
            if (!dataLoaded) {
                updateSaveStatus('è«‹å…ˆè¼‰å…¥ CSV æª”æ¡ˆ');
                return;
            }
            saveAsJPG();
        });

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                fileInfo.textContent = `å·²é¸æ“‡: ${file.name}`;
                fileInfo.classList.add('active');
                
                const fileName = file.name.replace(/\.[^/.]+$/, '');
                originalFileName = fileName;
                titleInput.value = fileName;
                chartTitle.textContent = fileName;
                chartTitle.style.display = 'inline-block';
                
                loadAndPlotCSV(file);
            }
        });

        function loadAndPlotCSV(file) {
            loading.classList.add('active');
            errorDiv.classList.remove('active');
            emptyState.style.display = 'none';

            Papa.parse(file, {
                complete: function(results) {
                    try {
                        plotData(results.data);
                        loading.classList.remove('active');
                        sidebar.classList.add('active');
                    } catch (error) {
                        showError('è³‡æ–™è§£æéŒ¯èª¤: ' + error.message);
                        loading.classList.remove('active');
                    }
                },
                error: function(error) {
                    showError('æª”æ¡ˆè®€å–éŒ¯èª¤: ' + error.message);
                    loading.classList.remove('active');
                },
                skipEmptyLines: true,
                encoding: 'CP1252'
            });
        }

        function plotData(data) {
            if (data.length < 2) {
                throw new Error('CSV æª”æ¡ˆè³‡æ–™ä¸è¶³');
            }

            const headers = data[0].map(h => {
                let header = h.trim();
                header = header.replace(/Â£\[/g, 'Î©');
                return header;
            });
            
            const xLabel = headers[0];
            const yAxisLabel = headers[headers.length - 1];
            const yColumns = headers.slice(1, headers.length - 1);
            
            const xData = [];
            const yDataSets = yColumns.map(() => []);
            
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                if (row.length < 2) continue;
                
                const xValue = parseFloat(row[0]);
                if (!isNaN(xValue)) {
                    xData.push(xValue);
                    
                    for (let j = 0; j < yColumns.length; j++) {
                        const yValue = parseFloat(row[j + 1]);
                        yDataSets[j].push(isNaN(yValue) ? null : yValue);
                    }
                }
            }
            
            currentTraces = yColumns.map((colName, idx) => {
                // æª¢æŸ¥åˆ—åæ˜¯å¦åŒ…å« "spec"ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰
                const isSpec = colName.toLowerCase().includes('spec');
                
                return {
                    x: xData,
                    y: yDataSets[idx],
                    mode: 'lines',
                    name: colName,
                    line: {
                        width: 2,
                        color: isSpec ? '#FF1493' : undefined,  // æ·±ç²‰ç´…è‰² (DeepPink)
                        dash: isSpec ? 'dash' : 'solid'         // è™›ç·šæˆ–å¯¦ç·š
                    },
                    hovertemplate: `<b>%{fullData.name}</b><br>X: %{x:.4f}<br>Y: %{y:.4f}<extra></extra>`
                };
            });
            
            currentLayout = {
                xaxis: {
                    title: {
                        text: xLabel,
                        font: {
                            size: 14,
                            color: '#333'
                        }
                    },
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    showspikes: false,
                    spikemode: 'across',
                    spikesnap: 'cursor',
                    spikecolor: '#4ecdc4',
                    spikethickness: 2,
                    spikedash: 'solid',
                    domain: [0, 0.95]
                },
                yaxis: {
                    title: {
                        text: yAxisLabel,
                        font: {
                            size: 14,
                            color: '#333'
                        }
                    },
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    showspikes: false,
                    spikemode: 'across',
                    spikesnap: 'cursor',
                    spikecolor: '#4ecdc4',
                    spikethickness: 2,
                    spikedash: 'solid'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 1.02,
                    y: 1,
                    xanchor: 'left',
                    yanchor: 'top',
                    bgcolor: 'rgba(255, 255, 255, 0.95)',
                    bordercolor: '#ddd',
                    borderwidth: 1,
                    font: {
                        size: 10,
                        family: 'Arial, sans-serif'
                    },
                    orientation: 'v',
                    traceorder: 'normal'
                },
                margin: {
                    l: 70,
                    r: 150,
                    t: 40,
                    b: 90
                },
                plot_bgcolor: '#fafafa',
                paper_bgcolor: 'white',
                autosize: true
            };
            
            currentConfig = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d']
            };
            
            // ä½¿ç”¨ newPlot å‰µå»ºåœ–è¡¨
            Plotly.newPlot(plotDiv, currentTraces, currentLayout, currentConfig).then(() => {
                // åœ–è¡¨å‰µå»ºå®Œæˆå¾Œè¨­ç½®
                dataLoaded = true;
            });
        }

        // SI å–®ä½å‰ç¶´è§£æå‡½æ•¸
        function parseSIValue(input) {
            if (!input) return NaN;

            const str = input.toString().trim();

            // SI å–®ä½å‰ç¶´å°ç…§è¡¨
            const siPrefixes = {
                'G': 1e9,    // Giga
                'M': 1e6,    // Mega
                'k': 1e3,    // kilo
                'm': 1e-3,   // milli
                'u': 1e-6,   // micro
                'n': 1e-9,   // nano
                'p': 1e-12   // pico
            };

            // åŒ¹é…æ‰€æœ‰ SI å‰ç¶´ï¼ˆå¤§å°å¯«æ•æ„Ÿï¼‰
            const match = str.match(/^([+-]?[\d.]+(?:e[+-]?\d+)?)\s*([GMkmunp])$/);

            if (match) {
                const number = parseFloat(match[1]);
                const prefix = match[2];  // ä¸è½‰æ›å¤§å°å¯«

                if (!isNaN(number) && siPrefixes[prefix]) {
                    return number * siPrefixes[prefix];
                }
            }
            // å¦‚æœæ²’æœ‰ SI å‰ç¶´ï¼Œå°±ç•¶ä½œæ™®é€šæ•¸å­—è§£æ
            return parseFloat(str);
        }

        function updatePlot() {
            if (!currentLayout || !currentTraces) return;
            
            const plotElement = document.getElementById('plotDiv');
            if (!plotElement || !plotElement.layout) {
                // å¦‚æœåœ–è¡¨é‚„æ²’å‰µå»ºï¼Œå…ˆå‰µå»ºå®ƒ
                Plotly.newPlot(plotDiv, currentTraces, currentLayout, currentConfig);
                return;
            }

            // å¥—ç”¨è»¸ç¯„åœ (Xè»¸æ”¯æ´ SI å‰ç¶´)
            const xMinVal = parseSIValue(xMin.value);
            const xMaxVal = parseSIValue(xMax.value);
            const yMinVal = parseFloat(yMin.value);
            const yMaxVal = parseFloat(yMax.value);
            
            var updateObj = {};
            
            if (!isNaN(xMinVal) && !isNaN(xMaxVal)) {
                updateObj['xaxis.range'] = [xMinVal, xMaxVal];
                updateObj['xaxis.autorange'] = false;
            } else {
                updateObj['xaxis.autorange'] = true;
            }
            
            if (!isNaN(yMinVal) && !isNaN(yMaxVal)) {
                updateObj['yaxis.range'] = [yMinVal, yMaxVal];
                updateObj['yaxis.autorange'] = false;
            } else {
                updateObj['yaxis.autorange'] = true;
            }
            
            if (Object.keys(updateObj).length > 0) {
                Plotly.relayout(plotDiv, updateObj);
            }
        }

        function showError(message) {
            errorDiv.textContent = message;
            errorDiv.classList.add('active');
            emptyState.style.display = 'flex';
            chartTitle.style.display = 'none';
        }

        function updateSaveStatus(message) {
            if (saveStatus) {
                saveStatus.textContent = message;
                setTimeout(() => {
                    if (saveStatus.textContent === message) {
                        saveStatus.textContent = '';
                    }
                }, 3000);
            }
        }

        function saveAsJPG() {
            try {
                updateSaveStatus('æ­£åœ¨ç”Ÿæˆ JPG åœ–ç‰‡...');
                
                // æº–å‚™æª”å
                const timestamp = new Date().toISOString().slice(0,19).replace(/:/g,'-').replace('T','_');
                const filename = `${originalFileName || 'chart'}_${timestamp}`;
                
                // ç²å–ç•¶å‰æ¨™é¡Œ
                const currentTitle = chartTitle.textContent || originalFileName || 'åœ–è¡¨';
                
                // æš«æ™‚æ·»åŠ æ¨™é¡Œåˆ°åœ–è¡¨
                Plotly.relayout(plotDiv, {
                    'title': {
                        text: currentTitle,
                        font: {
                            size: 20,
                            color: '#333',
                            family: 'Arial, sans-serif'
                        },
                        x: 0.5,
                        xanchor: 'center'
                    }
                }).then(() => {
                    // ä½¿ç”¨ Plotly çš„ downloadImage åŠŸèƒ½åŒ¯å‡º JPG
                    return Plotly.downloadImage(plotDiv, {
                        format: 'jpeg',
                        width: 1280,
                        height: 720,
                        filename: filename
                    });
                }).then(() => {
                    // åŒ¯å‡ºå®Œæˆå¾Œç§»é™¤æ¨™é¡Œï¼ˆæ¢å¾©åŸç‹€ï¼‰
                    return Plotly.relayout(plotDiv, {
                        'title': null
                    });
                }).then(() => {
                    updateSaveStatus('JPG åœ–ç‰‡å·²æˆåŠŸä¿å­˜ï¼š' + filename + '.jpeg');
                }).catch((error) => {
                    updateSaveStatus('ä¿å­˜ JPG å¤±æ•—ï¼š' + error.message);
                    console.error('Error saving JPG:', error);
                    // ç™¼ç”ŸéŒ¯èª¤ä¹Ÿè¦ç§»é™¤æ¨™é¡Œ
                    Plotly.relayout(plotDiv, {'title': null});
                });
                
            } catch (error) {
                updateSaveStatus('ä¿å­˜ JPG å¤±æ•—ï¼š' + error.message);
                console.error('Error saving JPG:', error);
            }
        }

        function saveAsNewHTML() {
            try {
                updateSaveStatus('æ­£åœ¨ç”Ÿæˆ HTML æª”æ¡ˆ...');
                
                // æ”¶é›†ç•¶å‰æ•¸æ“š
                const embeddedData = {
                    traces: currentTraces,
                    layout: currentLayout,
                    config: currentConfig,
                    fileName: originalFileName || 'åœ–è¡¨'
                };
                
                // æ”¶é›†ç•¶å‰è»¸ç¯„åœè¨­å®š
                const plotElement = document.getElementById('plotDiv');
                const embeddedRange = {
                    xaxis: {
                        range: plotElement && plotElement.layout && plotElement.layout.xaxis && plotElement.layout.xaxis.range 
                            ? plotElement.layout.xaxis.range.slice() : null,
                        autorange: plotElement && plotElement.layout && plotElement.layout.xaxis 
                            ? (plotElement.layout.xaxis.autorange !== false) : true
                    },
                    yaxis: {
                        range: plotElement && plotElement.layout && plotElement.layout.yaxis && plotElement.layout.yaxis.range 
                            ? plotElement.layout.yaxis.range.slice() : null,
                        autorange: plotElement && plotElement.layout && plotElement.layout.yaxis 
                            ? (plotElement.layout.yaxis.autorange !== false) : true
                    }
                };
                
                // ç”Ÿæˆæ–°çš„ HTML
                const newHTML = generateHTMLWithEmbeddedData(embeddedData, embeddedRange);
                
                // ä¸‹è¼‰æª”æ¡ˆ
                const timestamp = new Date().toISOString().slice(0,19).replace(/:/g,'-').replace('T','_');
                const filename = `${originalFileName || 'chart'}_saved_${timestamp}.html`;
                
                const blob = new Blob([newHTML], {type: 'text/html;charset=utf-8'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                updateSaveStatus('æª”æ¡ˆå·²æˆåŠŸä¿å­˜ï¼š' + filename);
                
            } catch (error) {
                updateSaveStatus('ä¿å­˜å¤±æ•—ï¼š' + error.message);
                console.error('Error saving HTML:', error);
            }
        }

        function generateHTMLWithEmbeddedData(embeddedData, embeddedRange) {
            try {
                // å®‰å…¨åœ°åºåˆ—åŒ–æ•¸æ“š
                const safeData = JSON.stringify(embeddedData, function(key, value) {
                    if (typeof value === 'function' || value === undefined) {
                        return null;
                    }
                    return value;
                }, 2);
                
                const safeRange = JSON.stringify(embeddedRange, function(key, value) {
                    if (typeof value === 'function' || value === undefined) {
                        return null;
                    }
                    return value;
                }, 2);
                
                // ç²å–ç•¶å‰ HTML å…§å®¹
                let html = document.documentElement.outerHTML;
                
                // æ­¥é©Ÿ 1: ç§»é™¤æ‰€æœ‰èˆŠçš„åµŒå…¥æ•¸æ“šå€å¡Šï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                // ä½¿ç”¨æ›´ç²¾ç¢ºçš„åŒ¹é…æ¨¡å¼
                html = html.replace(/\/\/ === åµŒå…¥çš„æ•¸æ“š ===[\s\S]*?\/\/ === åµŒå…¥ä»£ç¢¼çµæŸ ===\s*/g, '');
                
                // æ­¥é©Ÿ 2: ç§»é™¤èˆŠçš„è‡ªå‹•è¼‰å…¥é‚è¼¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                html = html.replace(/\/\/ è‡ªå‹•è¼‰å…¥åµŒå…¥æ•¸æ“š[\s\S]*?if \(typeof embeddedChartData[^}]+}\s*/g, '');
                
                // æ­¥é©Ÿ 3: å»ºç«‹è¦æ’å…¥çš„ JavaScript ä»£ç¢¼
                const dataScript = `
        // === åµŒå…¥çš„æ•¸æ“š ===
        let embeddedChartData = ${safeData};
        let embeddedAxisRange = ${safeRange};
        let isEmbeddedVersion = true;

        function loadEmbeddedData() {
            if (!embeddedChartData) return;
            
            try {
                currentTraces = embeddedChartData.traces;
                currentLayout = embeddedChartData.layout;
                currentConfig = embeddedChartData.config;
                originalFileName = embeddedChartData.fileName || 'åœ–è¡¨';
                
                // è¨­ç½®æ¨™é¡Œ
                const chartTitleElem = document.getElementById('chartTitle');
                const titleInputElem = document.getElementById('titleInput');
                if (chartTitleElem && titleInputElem) {
                    chartTitleElem.textContent = originalFileName;
                    titleInputElem.value = originalFileName;
                    chartTitleElem.style.display = 'inline-block';
                }
                
                // å‰µå»ºåœ–è¡¨
                const plotDivElem = document.getElementById('plotDiv');
                if (currentTraces && currentLayout && plotDivElem) {
                    Plotly.newPlot(plotDivElem, currentTraces, currentLayout, currentConfig).then(() => {
                        dataLoaded = true;
                        const sidebarElem = document.getElementById('sidebar');
                        const emptyStateElem = document.getElementById('emptyState');
                        if (sidebarElem) sidebarElem.classList.add('active');
                        if (emptyStateElem) emptyStateElem.style.display = 'none';
                        
                        // å¥—ç”¨è»¸ç¯„åœ
                        if (embeddedAxisRange) {
                            applyEmbeddedRange();
                        }
                        
                        // æ›´æ–°ç‹€æ…‹
                        const fileInfoElem = document.getElementById('fileInfo');
                        if (fileInfoElem) {
                            fileInfoElem.textContent = 'å·²è¼‰å…¥åµŒå…¥çš„åœ–è¡¨æ•¸æ“šï¼š' + originalFileName;
                            fileInfoElem.classList.add('active');
                        }
                    });
                }
                
            } catch (error) {
                console.error('è¼‰å…¥åµŒå…¥æ•¸æ“šå¤±æ•—:', error);
                if (typeof showError !== 'undefined') {
                    showError('è¼‰å…¥åµŒå…¥æ•¸æ“šå¤±æ•—ï¼š' + error.message);
                }
            }
        }

        function applyEmbeddedRange() {
            if (!embeddedAxisRange) return;
            const plotDivElem = document.getElementById('plotDiv');
            if (!plotDivElem || !window.Plotly) return;
            
            setTimeout(function() {
                try {
                    const updateObj = {};
                    const xMinElem = document.getElementById('xMin');
                    const xMaxElem = document.getElementById('xMax');
                    const yMinElem = document.getElementById('yMin');
                    const yMaxElem = document.getElementById('yMax');
                    
                    if (embeddedAxisRange.xaxis) {
                        if (!embeddedAxisRange.xaxis.autorange && embeddedAxisRange.xaxis.range) {
                            updateObj['xaxis.range'] = embeddedAxisRange.xaxis.range;
                            updateObj['xaxis.autorange'] = false;
                            
                            if (xMinElem && xMaxElem) {
                                xMinElem.value = embeddedAxisRange.xaxis.range[0].toFixed(4);
                                xMaxElem.value = embeddedAxisRange.xaxis.range[1].toFixed(4);
                            }
                        }
                    }
                    
                    if (embeddedAxisRange.yaxis) {
                        if (!embeddedAxisRange.yaxis.autorange && embeddedAxisRange.yaxis.range) {
                            updateObj['yaxis.range'] = embeddedAxisRange.yaxis.range;
                            updateObj['yaxis.autorange'] = false;
                            
                            if (yMinElem && yMaxElem) {
                                yMinElem.value = embeddedAxisRange.yaxis.range[0].toFixed(4);
                                yMaxElem.value = embeddedAxisRange.yaxis.range[1].toFixed(4);
                            }
                        }
                    }
                    
                    if (Object.keys(updateObj).length > 0) {
                        Plotly.relayout(plotDivElem, updateObj);
                    }
                    
                } catch (error) {
                    console.error('å¥—ç”¨åµŒå…¥ç¯„åœå¤±æ•—:', error);
                }
            }, 300);
        }
        
        // è‡ªå‹•è¼‰å…¥åµŒå…¥æ•¸æ“š
        if (typeof embeddedChartData !== 'undefined' && embeddedChartData) {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadEmbeddedData);
            } else {
                loadEmbeddedData();
            }
        }
        // === åµŒå…¥ä»£ç¢¼çµæŸ ===
`;
                
                // æ­¥é©Ÿ 4: åœ¨ç¬¬ä¸€å€‹ <script> æ¨™ç±¤å¾Œæ’å…¥æ•¸æ“šè…³æœ¬
                // å°‹æ‰¾ä¸»è¦çš„ script æ¨™ç±¤ï¼ˆä¸æ˜¯å¤–éƒ¨åº«ï¼‰
                const scriptStartPattern = /(<script>\s*)(const fileInput|let currentLayout)/;
                const match = html.match(scriptStartPattern);
                
                if (match) {
                    html = html.replace(scriptStartPattern, '$1' + dataScript + '\n        $2');
                } else {
                    console.error('æ‰¾ä¸åˆ°æ’å…¥é»');
                    throw new Error('ç„¡æ³•æ‰¾åˆ°åˆé©çš„è…³æœ¬æ’å…¥ä½ç½®');
                }
                
                return html;
                
            } catch (error) {
                console.error('ç”Ÿæˆ HTML æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                throw error;
            }
        }
    </script>
</body>
</html>
